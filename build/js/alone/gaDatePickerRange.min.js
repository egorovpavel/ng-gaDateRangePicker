var app=angular.module("gaDatePickerRange",[]);app.directive("focusOn",[function(){return function(t,e,a){return t.$on("focusOn",function(t,n){return n===a.focusOn?e[0].focus():void 0})}}]),app.factory("focus",["$rootScope","$timeout",function(t,e){return function(a){return e(function(){return t.$broadcast("focusOn",a)})}}]),app.directive("gaDateRangePicker",[function(){return{restrict:"A",transclude:!0,scope:{range1:"=",nMonth:"@",nChange:"=",labels:"="},template:'<div class="btn-group" role="group"><button type="button" class="btn btn-default" role="group" ng-click="movePeriod(-1)"><span class="glyphicon glyphicon-fast-backward" aria-hidden="true"></span></button><button type="button" class="btn btn-default" role="group" ng-click="switchDisplay( true )">{{range1.startLabel}} - {{range1.endLabel}}</button><button type="button" class="btn btn-default" role="group" ng-click="movePeriod(1)"><span class="glyphicon glyphicon-fast-forward" aria-hidden="true"></span></button></div><div class="gadpBox" ng-show="display"><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( -1 )"><span style="font-size: 12px;">&Lt;</span></button></div><div style="float:left;"><table class="gadpTable" cellpadding="0" cellspacing="0"><thead><tr><td class="gadpHeadTd" colspan="7" ng-repeat="month in calend.months track by $index">{{month.name}} {{month.year}}</td></tr></thead><tbody><tr><td class="gadpWeekDay" ng-repeat="weekDay in calend.weekDays track by $index">{{weekDay.substr(0,1).toUpperCase()}}</td></tr><tr ng-repeat="week in calend.weekGroups track by $index"><td class="gadpCell" ng-class="\'gadpCell\' + day.type" ng-click="setDate( day.date )" ng-repeat="day in week track by $index">{{day.numDay}}</td></tr></tbody></table></div><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( 1 )"><span style="font-size: 12px;">&Gt;</span></button></div><div style="float:left;margin-left: 10px"><div class="gadpText">{{labelsMap.period}} : <select ng-model="currentPeriod" ng-change="changePeriod()"><option ng-repeat="(key,period) in spePeriods" value="{{key}}" ng-selected="key==currentPeriod">{{period.label}}</option></select></div><div class="gadpDatesInputs"><form role="form" class="form-inline"><input type="text" class="form-control input-sm" focus-on="dateStart" ng-focus="focusDate(\'start\' , $event )" ng-model="dates.startLabel" ng-blur="dateBlur( \'start\' , dates.startLabel )">-<input type="text" class="form-control input-sm" focus-on="dateEnd" ng-focus="focusDate(\'end\' , $event )" ng-model="dates.endLabel" ng-blur="dateBlur( \'end\' , dates.endLabel )"></form></div><div class="gadpButtons"><button class="btn btn-primary btn-xs" ng-click="valid()">{{labelsMap.apply}}</button>&nbsp;<button class="btn btn-default btn-xs"ng-click="switchDisplay( false )">{{labelsMap.cancel}}</button></div></div><div style="clear: both"></div></div>',controller:["$scope","focus","$element","$attrs","$transclude",function(t,e,a,n,s){var r=moment().startOf("day");t.labelsMap=angular.extend({},{custom:"Personnalisée",today:"Aujourd'hui",yesterday:"Hier",thisWeek:"Semaine courante",lastWeek:"Semaine dernière",thisMonth:"Mois courant",lastMonth:"Mois dernier",last7Days:"Les 7 derniers jours",last30Days:"Les 30 derniers jours",apply:"Appliquer",period:"Période",cancel:"Annuler"},t.labels),t.spePeriods={1:{label:t.labelsMap.custom},2:{label:t.labelsMap.today,calculate:function(){l(r.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},3:{label:t.labelsMap.yesterday,calculate:function(){var t=angular.copy(r).subtract(1,"day");l(t.format("YYYY-MM-DD"),t.format("YYYY-MM-DD"))}},4:{label:t.labelsMap.thisWeek,calculate:function(){var t=angular.copy(r).startOf("week");l(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},5:{label:t.labelsMap.lastWeek,calculate:function(){var t=angular.copy(r).subtract(1,"week").startOf("week"),e=angular.copy(t).endOf("week");l(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},6:{label:t.labelsMap.thisMonth,calculate:function(){var t=angular.copy(r).startOf("month");l(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},7:{label:t.labelsMap.lastMonth,calculate:function(){var t=angular.copy(r).subtract(1,"month").startOf("month"),e=angular.copy(t).endOf("month");l(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},8:{label:t.labelsMap.last7Days,calculate:function(){var t=angular.copy(r).subtract(6,"day");l(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},9:{label:t.labelsMap.last30Days,calculate:function(){var t=angular.copy(r).subtract(29,"day");l(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}}},t.currentPeriod=1,t.changePeriod=function(){t.spePeriods[t.currentPeriod].calculate&&t.spePeriods[t.currentPeriod].calculate()};var l=function(e,a){t.dates={start:e,startLabel:moment(e).format("ll"),end:a,endLabel:moment(a).format("ll"),select:t.dates.select},t.calend=o(d.month(),d.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})};t.range1.start||(t.range1.start=r.format("YYYY-MM-DD")),t.range1.end||(t.range1.end=r.format("YYYY-MM-DD")),t.range1.startLabel=moment(t.range1.start).format("ll"),t.range1.endLabel=moment(t.range1.end).format("ll"),t.display=!1,t.nMonth||(t.nMonth=3);var o=function(e,a,n){n||(n={});var s=moment().startOf("day"),r=angular.copy(s),l=angular.copy(s).endOf("day");n.dateStart&&n.dateEnd&&(r=moment(n.dateStart).startOf("day"),l=moment(n.dateEnd).endOf("day"));for(var o=t.nMonth,d={weekDays:[],months:[]},c=[],m=0;7>m;m++)c.push(moment().weekday(m).format("ddd"));for(var u=(moment({y:a,M:e,d:1}),0),m=0;o>m;m++){var i=moment({y:a,M:e,d:1}).subtract(m,"month"),f={name:i.format("MMMM"),year:i.format("YYYY"),minWeekNum:60,maxWeekNum:0,numWeeks:0,weeks:[]},p=moment({y:a,M:e,d:1}).subtract(m,"month"),Y=0,y=0,b=0;do{y!=p.week()&&(b++,y=p.week()),f.weeks[b-1]||(f.weeks[b-1]=[],Y++);var g={numDay:p.get("date"),date:p.format("YYYY-MM-DD"),type:"nds"};p.isAfter(s)||(g.type="select"),(p.isSame(r)||p.isAfter(r)&&p.isBefore(l))&&(g.type="inRange"),f.weeks[b-1].push(g),p.add(1,"day")}while(1!=p.get("date"));var M=f.weeks[0].length;if(7>M)for(;f.weeks[0].unshift({numDay:"",type:"nds"})<7;);if(f.weeks[f.weeks.length-1].length<7)for(;f.weeks[f.weeks.length-1].push({numDay:"",type:"nds"})<7;);d.weekDays=d.weekDays.concat(c),d.months.unshift(angular.copy(f)),u=Math.max(u,Y)}for(var D=[],m=0;u>m;m++){D[m]||(D[m]=[]);for(var h=0;o>h;h++){var f=d.months[h];if(f.weeks[m])D[m]=D[m].concat(f.weeks[m]);else{var v={numDay:"",type:"nds"};D[m]=D[m].concat([v,v,v,v,v,v,v])}}}return d.weekGroups=D,d};t.switchDisplay=function(e){t.display=e},t.move=function(e){1==e&&d.add(1,"month"),-1==e&&d.subtract(1,"month"),t.calend=o(d.month(),d.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.focusDate=function(e){t.dates[e+"Label"]=moment(t.dates[e]).format("DD/MM/YYYY"),t.dates.select=e,t.currentPeriod=1},t.setDate=function(a){var n=moment(a);n.isBefore(t.dates.start)&&"end"==t.dates.select?(t.dates.start=a,t.dates.startLabel=moment(t.dates.start).format("ll"),t.dates.select="start"):(t.dates[t.dates.select]=a,t.dates[t.dates.select+"Label"]=moment(a).format("ll"),"start"==t.dates.select?(t.dates.select="end",e("dateEnd")):(t.dates.select="start",e("dateStart"))),moment(t.dates.start).isAfter(t.dates.end)&&(t.dates.end=angular.copy(t.dates.start),t.dates.endLabel=moment(t.dates.end).format("ll")),t.calend=o(d.month(),d.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dateBlur=function(e,a){moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).isValid()?(t.dates[e]=moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).format("YYYY-MM-DD"),t.dates[e+"Label"]=moment(t.dates[e]).format("ll")):t.dates[e+"Label"]=moment(t.dates[e]).format("ll"),t.calend=o(d.month(),d.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dates={start:angular.copy(t.range1.start),startLabel:moment(t.range1.start).format("ll"),end:angular.copy(t.range1.end),endLabel:moment(t.range1.end).format("ll"),select:"start"},t.valid=function(){t.range1={start:t.dates.start,startLabel:moment(t.dates.start).format("ll"),end:t.dates.end,endLabel:moment(t.dates.end).format("ll")},t.nChange&&t.nChange(t.range1),t.display=!1},t.movePeriod=function(e){var a=moment(t.dates.start),n=moment(t.dates.end),s=moment.duration(a.diff(n)),l=-s.asDays()+1;-1==e?(a.subtract(l,"days"),n.subtract(l,"days")):(a.add(l,"days"),n.add(l,"days")),t.dates={start:a.format("YYYY-MM-DD"),startLabel:a.format("ll"),end:n.format("YYYY-MM-DD"),endLabel:n.format("ll"),select:"start"},t.calend=o(r.month(),r.year(),{dateStart:t.dates.start,dateEnd:t.dates.end}),t.valid()},e("dateStart");var d=moment(t.dates.end);t.calend=o(r.month(),r.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})}]}}]);
//# sourceMappingURL=gaDatePickerRange.min.js.map