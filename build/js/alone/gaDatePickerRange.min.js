var app=angular.module("gaDatePickerRange",[]);app.directive("focusOn",[function(){return function(t,e,a){return t.$on("focusOn",function(t,n){return n===a.focusOn?e[0].focus():void 0})}}]),app.factory("focus",["$rootScope","$timeout",function(t,e){return function(a){return e(function(){return t.$broadcast("focusOn",a)})}}]),app.directive("gaDateRangePicker",[function(){return{restrict:"A",transclude:!0,scope:{range1:"=",nMonth:"@",nChange:"=",display:"=nDisplay",labels:"="},template:'<div class="btn-group" data-ng-click="noop($event)" role="group" ><span role="group" ng-click="switchDisplay( true )">{{range1.startLabel}} - {{range1.endLabel}}</button></div><div class="gadpBox" data-ng-click="noop($event)" ng-style="{display:display?\'block\':\'none\'}"><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( -1 )"><span style="font-size: 12px;">&Lt;</span></button></div><div style="float:left;"><table class="gadpTable" cellpadding="0" cellspacing="0"><thead><tr><td class="gadpHeadTd" colspan="7" ng-repeat="month in calend.months track by $index">{{month.name}} {{month.year}}</td></tr></thead><tbody><tr><td class="gadpWeekDay" ng-repeat="weekDay in calend.weekDays track by $index">{{weekDay.substr(0,1).toUpperCase()}}</td></tr><tr ng-repeat="week in calend.weekGroups track by $index"><td class="gadpCell" ng-class="\'gadpCell\' + day.type" ng-click="setDate( day.date )" ng-repeat="day in week track by $index">{{day.numDay}}</td></tr></tbody></table></div><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( 1 )"><span style="font-size: 12px;">&Gt;</span></button></div><div style="float:left;margin-left: 10px"><div class="gadpText">{{labelsMap.period}} : <div ss-class="form-control" select-search="spePeriods" ng-model="currentPeriod" content="label" key="id"></div></div><div class="gadpDatesInputs"><form role="form" class="form-inline"><input type="text" class="form-control input-sm" focus-on="dateStart" ng-focus="focusDate(\'start\' , $event )" ng-model="dates.startLabel" ng-blur="dateBlur( \'start\' , dates.startLabel )">-<input type="text" class="form-control input-sm" focus-on="dateEnd" ng-focus="focusDate(\'end\' , $event )" ng-model="dates.endLabel" ng-blur="dateBlur( \'end\' , dates.endLabel )"></form></div></div><div style="clear: both"></div></div>',controller:["$scope","focus","$element","$attrs","$transclude",function(t,e,a,n,s){var r=moment().startOf("day");t.labelsMap=angular.extend({},{custom:"Personnalisée",today:"Aujourd'hui",yesterday:"Hier",thisWeek:"Semaine courante",lastWeek:"Semaine dernière",thisMonth:"Mois courant",lastMonth:"Mois dernier",last7Days:"Les 7 derniers jours",last30Days:"Les 30 derniers jours",apply:"Appliquer",period:"Période",cancel:"Annuler"},t.labels),t.spePeriods=[{id:1,label:t.labelsMap.custom},{id:2,label:t.labelsMap.today,calculate:function(){d(r.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},{id:3,label:t.labelsMap.yesterday,calculate:function(){var t=angular.copy(r).subtract(1,"day");d(t.format("YYYY-MM-DD"),t.format("YYYY-MM-DD"))}},{id:4,label:t.labelsMap.thisWeek,calculate:function(){var t=angular.copy(r).startOf("week");d(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},{id:5,label:t.labelsMap.lastWeek,calculate:function(){var t=angular.copy(r).subtract(1,"week").startOf("week"),e=angular.copy(t).endOf("week");d(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},{id:6,label:t.labelsMap.thisMonth,calculate:function(){var t=angular.copy(r).startOf("month");d(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},{id:7,label:t.labelsMap.lastMonth,calculate:function(){var t=angular.copy(r).subtract(1,"month").startOf("month"),e=angular.copy(t).endOf("month");d(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},{id:8,label:t.labelsMap.last7Days,calculate:function(){var t=angular.copy(r).subtract(6,"day");d(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}},{id:9,label:t.labelsMap.last30Days,calculate:function(){var t=angular.copy(r).subtract(29,"day");d(t.format("YYYY-MM-DD"),r.format("YYYY-MM-DD"))}}],t.currentPeriod=1,t.$watch("currentPeriod",function(a,n){a&&t.spePeriods[t.currentPeriod-1].calculate&&(t.spePeriods[t.currentPeriod-1].calculate(),e("dateStart"))});var d=function(e,a){t.dates={start:e,startLabel:moment(e).format("ll"),end:a,endLabel:moment(a).format("ll"),select:t.dates.select},t.calend=o(l.month(),l.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})};t.noop=function(t){t.stopPropagation()},t.range1.start||(t.range1.start=r.format("YYYY-MM-DD")),t.range1.end||(t.range1.end=r.format("YYYY-MM-DD")),t.range1.startLabel=moment(t.range1.start).format("ll"),t.range1.endLabel=moment(t.range1.end).format("ll"),t.display=!1,t.focus=function(){t.display=!0},t.nMonth||(t.nMonth=3);var o=function(e,a,n){n||(n={});var s=moment().startOf("day"),r=angular.copy(s),d=angular.copy(s).endOf("day");n.dateStart&&n.dateEnd&&(r=moment(n.dateStart).startOf("day"),d=moment(n.dateEnd).endOf("day"));for(var o=t.nMonth,l={weekDays:[],months:[]},c=[],m=0;7>m;m++)c.push(moment().weekday(m).format("ddd"));for(var i=(moment({y:a,M:e,d:1}),0),m=0;o>m;m++){var u=moment({y:a,M:e,d:1}).subtract(m,"month"),f={name:u.format("MMMM"),year:u.format("YYYY"),minWeekNum:60,maxWeekNum:0,numWeeks:0,weeks:[]},Y=moment({y:a,M:e,d:1}).subtract(m,"month"),p=0,y=0,D=0;do{y!=Y.week()&&(D++,y=Y.week()),f.weeks[D-1]||(f.weeks[D-1]=[],p++);var g={numDay:Y.get("date"),date:Y.format("YYYY-MM-DD"),type:"nds"};Y.isAfter(s)||(g.type="select"),(Y.isSame(r)||Y.isAfter(r)&&Y.isBefore(d))&&(g.type="inRange"),f.weeks[D-1].push(g),Y.add(1,"day")}while(1!=Y.get("date"));var M=f.weeks[0].length;if(7>M)for(;f.weeks[0].unshift({numDay:"",type:"nds"})<7;);if(f.weeks[f.weeks.length-1].length<7)for(;f.weeks[f.weeks.length-1].push({numDay:"",type:"nds"})<7;);l.weekDays=l.weekDays.concat(c),l.months.unshift(angular.copy(f)),i=Math.max(i,p)}for(var b=[],m=0;i>m;m++){b[m]||(b[m]=[]);for(var v=0;o>v;v++){var f=l.months[v];if(f.weeks[m])b[m]=b[m].concat(f.weeks[m]);else{var h={numDay:"",type:"nds"};b[m]=b[m].concat([h,h,h,h,h,h,h])}}}return l.weekGroups=b,l};t.switchDisplay=function(e){t.display=e},t.move=function(e){1==e&&l.add(1,"month"),-1==e&&l.subtract(1,"month"),t.calend=o(l.month(),l.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.focusDate=function(e){t.dates[e+"Label"]=moment(t.dates[e]).format("DD/MM/YYYY"),t.dates.select=e,t.currentPeriod=1},t.setDate=function(a){var n=moment(a);n.isBefore(t.dates.start)&&"end"==t.dates.select?(t.dates.start=a,t.dates.startLabel=moment(t.dates.start).format("ll"),t.dates.select="start"):(t.dates[t.dates.select]=a,t.dates[t.dates.select+"Label"]=moment(a).format("ll"),"start"==t.dates.select?(t.dates.select="end",e("dateEnd")):(t.dates.select="start",e("dateStart"))),moment(t.dates.start).isAfter(t.dates.end)&&(t.dates.end=angular.copy(t.dates.start),t.dates.endLabel=moment(t.dates.end).format("ll")),t.calend=o(l.month(),l.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dateBlur=function(e,a){moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).isValid()?(t.dates[e]=moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).format("YYYY-MM-DD"),t.dates[e+"Label"]=moment(t.dates[e]).format("ll")):t.dates[e+"Label"]=moment(t.dates[e]).format("ll"),t.calend=o(l.month(),l.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dates={start:angular.copy(t.range1.start),startLabel:moment(t.range1.start).format("ll"),end:angular.copy(t.range1.end),endLabel:moment(t.range1.end).format("ll"),select:"start"},t.close=function(){t.range1={start:t.dates.start,startLabel:moment(t.dates.start).format("ll"),end:t.dates.end,endLabel:moment(t.dates.end).format("ll")},t.nChange&&t.nChange(t.range1),t.display=!1},t.movePeriod=function(e){var a=moment(t.dates.start),n=moment(t.dates.end),s=moment.duration(a.diff(n)),d=-s.asDays()+1;-1==e?(a.subtract(d,"days"),n.subtract(d,"days")):(a.add(d,"days"),n.add(d,"days")),t.dates={start:a.format("YYYY-MM-DD"),startLabel:a.format("ll"),end:n.format("YYYY-MM-DD"),endLabel:n.format("ll"),select:"start"},t.calend=o(r.month(),r.year(),{dateStart:t.dates.start,dateEnd:t.dates.end}),t.valid()},e("dateStart");var l=moment(t.dates.end);t.calend=o(r.month(),r.year(),{dateStart:t.dates.start,dateEnd:t.dates.end}),t.$on("closeDD",function(e){console.log("CLOSE ALL event",e),t.close()})}]}}]);
//# sourceMappingURL=gaDatePickerRange.min.js.map